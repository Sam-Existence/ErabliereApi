<div>
    <h3 i18n="alertesTitre">Alertes</h3>
</div>
<ajouter-alerte-modal *ngIf="!displayEditForm" [idErabliereSelectionee]="idErabliereSelectionee" [alertes]="alertes"
    [alertesCapteur]="alertesCapteur">
</ajouter-alerte-modal>
<modifier-alerte-modal *ngIf="displayEditForm || displayEditAlerteCapteurForm"
    [idErabliereSelectionee]="idErabliereSelectionee" [displayEditFormSubject]="displayEditFormSubject"
    [alerteEditFormSubject]="alerteEditFormSubject" [alerte]="alerteEditForm"
    [alerteCapteurEditFormSubject]="alerteCapteurEditFormSubject" [alerteCapteur]="alerteCapteurEditForm"
    [editAlerte]="editAlerte" [editAlerteCapteur]="editAlerteCapteur">
</modifier-alerte-modal>
<div>
    <p *ngIf="alertes != null && alertes.length == 0 && alertesCapteur != null && alertesCapteur.length == 0">
        Aucune alerte configurée
    </p>

    <div *ngIf="alertesCapteur != null && alertesCapteur.length > 0">
        <h4 i18n="alertesCapteur">Alertes de capteur</h4>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th i18n="id">
                        Id
                    </th>
                    <th i18n="nom">
                        Nom
                    </th>
                    <th i18n="etat">
                        État
                    </th>
                    <th i18n="envoyerA">
                        Envoyer à
                    </th>
                    <th i18n="texterA">
                        Texter à
                    </th>
                    <th i18n="min">
                        Min.
                    </th>
                    <th i18n="max">
                        Max.
                    </th>
                    <th i18n="capteur">
                        Capteur
                    </th>
                    <th></th>
                <tr>
            </thead>
            <tbody>
                <tr *ngFor="let alerte of alertesCapteur">
                    <td class="shortid">
                        {{alerte.id}}
                    </td>
                    <td>
                        {{alerte.nom}}
                    </td>
                    <td *ngIf="alerte.isEnable" i18n="active">
                        Activé
                    </td>
                    <td *ngIf="!alerte.isEnable" i18n="desactive">
                        Désactivé
                    </td>
                    <td>
                        <span *ngFor="let email of alerte.emails" class="feature_desc">{{email}}</span>
                    </td>
                    <td>
                        <span *ngFor="let numero of alerte.numeros" class="feature_desc">{{numero}}</span>
                    </td>
                    <td>
                        {{formatNumber(alerte.minVaue, alerte.capteur?.symbole)}}
                    </td>
                    <td>
                        {{formatNumber(alerte.maxValue, alerte.capteur?.symbole)}}
                    </td>
                    <td>
                        {{alerte.capteur?.nom}}
                    </td>
                    <td>
                        <div class="d-grid gap-3">
                            <button *ngIf="alerte.isEnable" class="btn btn-outline-warning"
                                (click)="onButtonDesactiverAlerteCapteurClick(alerte.idCapteur, alerte.id)" i18n="boutonDesactiver">Désactiver</button>
                            <button *ngIf="!alerte.isEnable" class="btn btn-outline-success"
                                (click)="onButtonActiverAlerteCapteurClick(alerte.idCapteur, alerte.id)" i18n="boutonActiver">Activer</button>
                            <button class="btn btn-info"
                                (click)="onButtonModifierAlerteCapteurClick(alerte.id)" i18n="boutonModifier">Modifier</button>
                            <button class="btn btn-danger"
                                (click)="onButtonDeleteAlerteCapteurClick(alerte.idCapteur, alerte.id)" i18n="boutonSupprimer">Supprimer</button>

                        </div>
                    </td>
                <tr>
            </tbody>
        </table>
    </div>

    <div *ngIf="alertes != null && alertes.length > 0">
        <h4 i18n="AlertesTrioDonnees">Alertes de trio données</h4>
        <table *ngIf="alertes != null && alertes.length > 0" class="table table-striped">
            <thead>
                <tr>
                    <th i18n="id">
                        Id
                    </th>
                    <th i18n="nom">
                        Nom
                    </th>
                    <th i18n="etat">
                        État
                    </th>
                    <th i18n="envoyerA">
                        Envoyer à
                    </th>
                    <th i18n="texterA">
                        Texter à
                    </th>
                    <th i18n="temperatureMin">
                        Température min.
                    </th>
                    <th i18n="temperatureMax">
                        Température max.
                    </th>
                    <th i18n="vacuumMin">
                        Vacuum min.
                    </th>
                    <th i18n="vacuumMax">
                        Vacuum max.
                    </th>
                    <th i18n="niveauBassinMin">
                        Niveau bassin min.
                    </th>
                    <th i18n="niveauBassinMax">
                        Niveau bassin max.
                    </th>
                    <th></th>
                <tr>
            </thead>
            <tbody>
                <tr *ngFor="let alerte of alertes">
                    <td class="shortid">
                        {{alerte.id}}
                    </td>
                    <td>
                        {{alerte.nom}}
                    </td>
                    <td *ngIf="alerte.isEnable" i18n="active">
                        Activé
                    </td>
                    <td *ngIf="!alerte.isEnable" i18n="desactive">
                        Désactivé
                    </td>
                    <td>
                        <span *ngFor="let email of alerte.emails" class="feature_desc">{{email}}</span>
                    </td>
                    <td>
                        <span *ngFor="let numero of alerte.numeros" class="feature_desc">{{numero}}</span>
                    </td>
                    <td>
                        {{formatStringNumber(alerte.temperatureThresholdHight, "°C")}}
                    </td>
                    <td>
                        {{formatStringNumber(alerte.temperatureThresholdLow, "°C")}}
                    </td>
                    <td>
                        {{formatStringNumber(alerte.vacciumThresholdHight, "HG")}}
                    </td>
                    <td>
                        {{formatStringNumber(alerte.vacciumThresholdLow, "HG")}}
                    </td>
                    <td>
                        {{formatStringNumberBase10(alerte.niveauBassinThresholdHight, "%")}}
                    </td>
                    <td>
                        {{formatStringNumberBase10(alerte.niveauBassinThresholdLow, "%")}}
                    </td>
                    <td>
                        <div class="d-grid gap-3">
                            <button *ngIf="alerte.isEnable" class="btn btn-outline-warning"
                                (click)="onButtonDesactiverAlerteClick(alerte.id)" i18n="boutonDesactiver">Désactiver</button>
                            <button *ngIf="!alerte.isEnable" class="btn btn-outline-success"
                                (click)="onButtonActiverAlerteClick(alerte.id)" i18n="boutonActiver">Activer</button>
                            <button class="btn btn-info" (click)="onButtonModifierClick(alerte.id)" i18n="boutonModifier">Modifier</button>
                            <button class="btn btn-danger" (click)="onButtonDeleteClick(alerte.id)" i18n="boutonSupprimer">Supprimer</button>
                        </div>
                    </td>
                <tr>
            </tbody>
        </table>
    </div>
</div>